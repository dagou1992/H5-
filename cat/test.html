<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        .img-area{width: 500px;height: 500px; margin: 0 auto;}
        .my-photo{width:500px; height: 300px}
    </style>
</head>
<body>
<div class="container">
    <div class="img-area"><img class="my-photo" alt="loading" data-src="./img/1.jpg" /></div>
    <div class="img-area"><img class="my-photo" alt="loading" data-src="./img/2.jpg" /></div>
    <div class="img-area"><img class="my-photo" alt="loading" data-src="./img/3.jpg" /></div>
    <div class="img-area"><img class="my-photo" alt="loading" data-src="./img/4.jpg" /></div>
    <div class="img-area"><img class="my-photo" alt="loading" data-src="./img/5.jpg" /></div>
    <div class="img-area"><img class="my-photo" alt="loading" data-src="./img/1.jpg" /></div>
    <div class="img-area"><img class="my-photo" alt="loading" data-src="./img/2.jpg" /></div>
    <div class="img-area"><img class="my-photo" alt="loading" data-src="./img/3.jpg" /></div>
    <div class="img-area"><img class="my-photo" alt="loading" data-src="./img/4.jpg" /></div>
    <div class="img-area"><img class="my-photo" alt="loading" data-src="./img/5.jpg" /></div>
</div>
<script>
    //  IntersectionObserver 传入 callback
    var io = new IntersectionObserver(function (ioes) {
        ioes.forEach(function (ioe) {
            var el = ioe.target
            var intersectionRatio = ioe.intersectionRatio
            console.log(intersectionRatio)
            if (intersectionRatio > 0 && intersectionRatio <= 1) {
                loadImg(el)
            }
            el.onload = el.onerror = function() {
                io.unobserve(el);
            }
        })
    })

    function checkImg() {
        var imgs = Array.from(document.querySelectorAll('.my-photo'))
        imgs.forEach(function(item) {io.observe(item)})
    }

    function loadImg(el) {
        if (!el.src) {
            el.src = el.dataset.src
        }
    }

    checkImg()
</script>
</body>
</html>
